<Window x:Class="BartsTOK.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Barts TOK" Height="900" Width="900"
    WindowStartupLocation="CenterScreen"
    Background="#1e1e1e"
    Foreground="#ffffff"
    Icon="pack://application:,,,/bart.ico">
    <!-- Layout: keep main content scaled with a centered Viewbox, but place the
         action buttons and status/log in a footer that is always visible at the
         bottom of the window. This prevents the buttons from disappearing when
         the window is resized smaller. -->
    <DockPanel LastChildFill="True">
        <Viewbox Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Top" DockPanel.Dock="Top">
            <!-- Let the inner Grid size to its content so there's no large empty gap
                 between the input area and the footer. Previously a fixed Height
                 left a lot of empty space. -->
            <Grid Width="800" Height="Auto" Margin="12">
                <!-- pack content to the top so footer comes closer when window is large -->
                <StackPanel VerticalAlignment="Top" HorizontalAlignment="Stretch">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,16">
                        <Image x:Name="imgHeaderLeft" Width="32" Height="32" Margin="0,0,8,0" Source="pack://application:,,,/loading.gif" />
                        <TextBlock Text="BARTS TOK" FontSize="20" FontWeight="Bold" 
                                   Foreground="#FFD700" TextAlignment="Center" VerticalAlignment="Center" />
                        <Image x:Name="imgHeaderRight" Width="32" Height="32" Margin="8,0,0,0" Source="pack://application:,,,/loading.gif" />
                    </StackPanel>

                    <GroupBox Header="Virtuelle Tastatur" Foreground="#FFD700" Margin="0,0,0,10">
                        <StackPanel Margin="6">
                            <RadioButton x:Name="rbSendInput" Content="SendInput Keyboard (Standard)" 
                                         IsChecked="True" Foreground="white" Margin="0,0,0,6"/>
                            <RadioButton x:Name="rbSendKeys" Content="SendKeys Keyboard" 
                                         Foreground="white" Margin="0,0,0,6"/>
                            <RadioButton x:Name="rbKeybdEvent" Content="KeybdEvent Keyboard (Alt)" 
                                         Foreground="white"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Verhalten" Foreground="#FFD700" Margin="0,0,0,10">
                        <StackPanel Margin="6">
                            <RadioButton x:Name="rbSequential" Content="Zeilen nacheinander" 
                                         IsChecked="True" Foreground="white" Margin="0,0,0,6"/>
                            <RadioButton x:Name="rbRandom" Content="Zufällige Zeile" 
                                         Foreground="white" Margin="0,0,0,6"/>
                            <RadioButton x:Name="rbSequentialStop" Content="Nacheinander und stoppen" 
                                         Foreground="white" Margin="0,0,0,6"/>
                            <CheckBox x:Name="cbAutoNewline" Content="Auto Enter nach jeder Zeile" 
                                      IsChecked="True" Foreground="white" Margin="0,6,0,0"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Tippgeschwindigkeit" Foreground="#FFD700" Margin="0,0,0,10">
                        <StackPanel Margin="6">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                <Label Content="Pause zwischen Zeilen (Sek):" Width="150" Foreground="white"/>
                                <TextBox x:Name="txtLinePause" Width="60" Text="5" TextAlignment="Center" 
                                         Background="#333333" Foreground="white"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <Label Content="Pause zwischen Zeichen (Sek):" Width="150" Foreground="white"/>
                                <TextBox x:Name="txtCharPause" Width="60" Text="0.01" TextAlignment="Center" 
                                         Background="#333333" Foreground="white"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <Label Content="Text Eingaben (jede Zeile wird separat behandelt):" 
                           Foreground="#FFD700" FontWeight="Bold"/>
                    <TextBox x:Name="txtInput" Height="100" Margin="0,4,0,4" 
                             TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                             AcceptsReturn="True" Background="#333333" Foreground="white" Padding="6"/>

                </StackPanel>
            </Grid>
        </Viewbox>

        <!-- Footer: action buttons + status + log always visible -->
        <Border DockPanel.Dock="Bottom" Background="Transparent" Padding="10">
            <StackPanel>
        <Grid Margin="0,0,0,8" Height="40">
            <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Button x:Name="btnStart" Content="▶ START (F1)"
                Background="#4CAF50" Foreground="Black" FontSize="12"
                FontWeight="Bold" Click="BtnStart_Click" Margin="0,0,10,0"
                HorizontalAlignment="Stretch" Grid.Column="0"/>
            <Button x:Name="btnStop" Content="⏹ STOP (F2)"
                Background="#F44336" Foreground="Black" FontSize="12"
                FontWeight="Bold" Click="BtnStop_Click" IsEnabled="False"
                HorizontalAlignment="Stretch" Grid.Column="1"/>
                    <Button x:Name="btnOpenMoveBart"
                            Background="#2196F3" Foreground="Black" FontSize="12"
                            FontWeight="Bold" Click="BtnOpenMoveBart_Click"
                            HorizontalAlignment="Right" Width="110" Grid.Column="2">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="MoveBart" FontWeight="Bold" HorizontalAlignment="Center" />
                            <TextBlock Text="(beta)" FontSize="10" HorizontalAlignment="Center" />
                        </StackPanel>
                    </Button>
        </Grid>

                <!-- Input anchor controls: bind the text input target window -->
                <StackPanel Orientation="Horizontal" Margin="0,6,0,0" HorizontalAlignment="Right">
                    <CheckBox x:Name="cbAnchorInput" Content="Anchor Input" Foreground="white" VerticalAlignment="Center" />
                    <Button x:Name="btnSetInputTarget" Content="Set Input Target" Width="120" Margin="8,0,0,0" Click="BtnSetInputTarget_Click" />
                    <!-- Help / description button: shows a short popup explaining how Set Input Target works -->
                    <Button x:Name="btnHelpTarget" Width="24" Height="24" Margin="6,0,0,0" Click="BtnHelpTarget_Click" ToolTip="Hilfe: Zielfenster festlegen"
                            Background="Transparent" BorderBrush="#FFD700" BorderThickness="1" Padding="0">
                        <!-- Use a font glyph so no external image is required -->
                        <TextBlock Text="?" Foreground="#FFD700" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" TextAlignment="Center" />
                    </Button>
                    <TextBlock Text="Target:" Foreground="white" VerticalAlignment="Center" Margin="8,0,0,0" />
                    <Label x:Name="lblTargetWindow" Content="(none)" Foreground="#FFD700" VerticalAlignment="Center" Margin="6,0,0,0" />
                </StackPanel>

                <Label Content="Status:" Foreground="#FFD700" FontWeight="Bold"/>

                <Grid Margin="0,6,0,0" Height="48">
                    <Grid.ColumnDefinitions>
                        <!-- Make the first column take remaining space so the image sits at the far right -->
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- status label: let it size naturally but not full width -->
                    <Label x:Name="lblStatus" Content="Status: Gestoppt ⏹" Height="36"
                           Background="#333333" BorderBrush="#FFD700" BorderThickness="1"
                           Foreground="white" Padding="10" FontSize="13"
                           VerticalContentAlignment="Center" HorizontalContentAlignment="Left" Grid.Column="0" />

                    <Image x:Name="imgLoading" Source="pack://application:,,,/loading.gif"
                           Height="48" Width="48" Visibility="Collapsed" Grid.Column="1"
                           Margin="12,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Right" />
                </Grid>

                    <!-- Option: minimize to tray when the checkbox is checked -->
                    <CheckBox x:Name="cbMinimizeToTray" Content="Minimiert im Tray behalten"
                              Foreground="white" Margin="0,8,0,0" IsChecked="True" />

                <Expander Header="Log" Foreground="#FFD700" FontWeight="Bold" IsExpanded="False" Margin="0,12,0,0">
                    <ListBox x:Name="logBox" Height="120" Background="#333333" 
                             BorderBrush="#FFD700" BorderThickness="1" Foreground="#00FF00"/>
                </Expander>
                <!-- Advanced settings moved to a separate dialog -->
                <StackPanel Orientation="Horizontal" Margin="0,12,0,0" HorizontalAlignment="Left">
                    <Button x:Name="btnAdvancedSettings" Content="Erweiterte Einstellungen" Width="190" Height="28" Click="BtnAdvancedSettings_Click" />
                    <Button x:Name="btnAbout" Content="Über" Width="90" Height="28" Margin="8,0,0,0" Click="BtnAbout_Click" />
                </StackPanel>
            </StackPanel>
        </Border>
    </DockPanel>
</Window>